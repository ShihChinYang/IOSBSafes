(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[455],{26028:function(e,r,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/services/mfaSetup",function(){return s(22189)}])},18001:function(e,r,s){"use strict";s.d(r,{Z:function(){return d}});var n=s(85893),t=s(67294),a=s(76529),i=s(14153),c=s(51417),l=s(82354),o=s.n(l);function d(e){let{onKeyChanged:r,recoveredKeyPassword:s,focus:l=!1}=e,d=(0,t.useRef)(null),[u,h]=(0,t.useState)(""),[x,j]=(0,t.useState)(!0);return(0,t.useEffect)(()=>{s&&h(s)},[s]),(0,t.useEffect)(()=>{l&&d.current.focus()},[l]),(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(c.Z,{children:[(0,n.jsx)(i.Z.Control,{ref:d,type:x?"password":"text",onChange:e=>{h(e.target.value),r(e.target.value)},value:u,className:o().inputBox}),(0,n.jsx)(a.Z,{className:o().inputButton,onClick:e=>{j(!x)},variant:"dark",children:x?(0,n.jsx)("i",{id:"1",className:"fa fa-eye-slash fa-lg","aria-hidden":"true"}):(0,n.jsx)("i",{id:"1",className:"fa fa-eye fa-lg","aria-hidden":"true"})})]})})}s(28714)},22189:function(e,r,s){"use strict";s.r(r),s.d(r,{default:function(){return g}});var n=s(85893),t=s(67294),a=s(9473),i=s(33353),c=s(68888),l=s(88083),o=s(14153),d=s(76529),u=s(56693),h=s(51417),x=s(92592),j=s(82354),f=s.n(j),p=s(81011),y=s(18001),v=s(70562),Z=s(28714),m=s(37383);function g(){let e=(0,a.I0)(),[r,s]=(0,t.useState)(""),[j,g]=(0,t.useState)(!1),[w,C]=(0,t.useState)(null),[S,k]=(0,t.useState)(!1),[N,b]=(0,t.useState)(!1),[E,A]=(0,t.useState)(null),[_,F]=(0,t.useState)(""),[R,T]=(0,t.useState)(!1),[B,I]=(0,t.useState)(!1),[z,D]=(0,t.useState)(!1),[H,O]=(0,t.useState)(null),[U,q]=(0,t.useState)(!1),[L,P]=(0,t.useState)(""),W=(0,t.useRef)(null),Y=(0,a.v9)(e=>e.auth.isLoggedIn),Q=(0,a.v9)(e=>e.auth.keySalt),G=(0,a.v9)(e=>e.account.accountHashVerified),V=(0,a.v9)(e=>e.account.mfa),X=async()=>{let s=await (0,v.IA)(r,Q);e((0,m.q$)({accountHash:s}))},K=async()=>{try{e((0,m.Qz)({token:_,accountHash:w})),F("")}catch(e){alert(e)}},$=()=>{confirm("Did you save your 2FA recovery phase? Close this?")&&I(!1)},J=()=>{P(""),q(!1)},M=async()=>{e((0,m._n)({accountHash:w})),J()};return(0,t.useEffect)(()=>{Y&&e((0,m.DR)())},[Y]),(0,t.useEffect)(()=>{!w&&Q?k(!0):k(!1)},[w,Q]),(0,t.useEffect)(()=>{G&&G.verified&&(s(""),C(G.accountHash))},[G]),(0,t.useEffect)(()=>{if(V){if(V.mfaSetup){let e=new File([V.recoveryWords],"2FA.txt",{type:"text/plain"});O(URL.createObjectURL(e)),D(!1),I(!0)}else if("InvalidToken"===V.error){F("");return}V.mfaEnabled?b(!0):(b(!1),V.otpAuthUrl?(async()=>{try{let e=await x.toDataURL(V.otpAuthUrl);A(e)}catch(e){(0,Z.qu)(!1,"QRCode error.")}})():e((0,m.DR)()))}},[V]),(0,n.jsx)(p.Z,{children:(0,n.jsxs)(i.Z,{children:[(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),N?(0,n.jsx)("div",{className:"m-3",children:(0,n.jsxs)(l.Z,{xs:12,children:[(0,n.jsx)("h1",{children:"2FA is enabled."}),(0,n.jsx)(d.Z,{variant:"warning",className:"py-2",onClick:()=>q(!0),children:"Disable"}),(0,n.jsx)(u.Z,{show:U,onEntered:()=>{W.current.focus()},onHide:J,children:(0,n.jsxs)(u.Z.Body,{children:[(0,n.jsx)("h3",{children:"Are you sure?"}),(0,n.jsx)(o.Z,{children:(0,n.jsx)(h.Z,{className:"mb-3",children:(0,n.jsx)(o.Z.Control,{ref:W,size:"lg",type:"text",value:L,onChange:e=>P(e.target.value),placeholder:"Yes"})})}),(0,n.jsx)(d.Z,{variant:"primary",className:"pull-right",size:"md",onClick:M,disabled:"Yes"!==L,children:"Go"}),(0,n.jsx)(d.Z,{variant:"light",className:"pull-right",size:"md",onClick:J,children:"Cancel"})]})}),(0,n.jsxs)(u.Z,{show:B,fullscreen:!0,onHide:$,children:[(0,n.jsx)(u.Z.Header,{closeButton:!0,children:(0,n.jsx)(u.Z.Title,{children:"2FA Recovery Words"})}),(0,n.jsxs)(u.Z.Body,{children:[(0,n.jsx)("p",{children:"Store your recovery words in a secure location. If you lose your 2FA authenticator account, using recovery words is the only way to pass the 2FA step."}),(0,n.jsx)("p",{children:"You can either copy the following recovery words and paste it to a safe location"}),(0,n.jsx)("hr",{}),(0,n.jsx)("h3",{children:V&&V.recoveryWords}),(0,n.jsx)("hr",{}),(0,n.jsx)(c.Z,{children:(0,n.jsx)(l.Z,{className:"text-center",children:(0,n.jsx)(d.Z,{variant:"primary",onClick:()=>{navigator.clipboard.writeText(V.recoveryWords),D(!0)},children:z?"Copied":"Copy"})})}),(0,n.jsx)("br",{}),!1,(0,n.jsx)("hr",{}),(0,n.jsx)(c.Z,{children:(0,n.jsx)(l.Z,{className:"d-flex justify-content-center",children:(0,n.jsx)(d.Z,{className:"text-center",variant:"warning",onClick:$,children:"Done"})})})]})]})]})}):(0,n.jsxs)("div",{className:"m-3",children:[(0,n.jsx)(c.Z,{children:(0,n.jsx)("h1",{children:"Turn On 2FA"})}),(0,n.jsx)(c.Z,{children:(0,n.jsx)("p",{children:"Step 1. Open your authenticator app., or download one if you don't have any;"})}),(0,n.jsxs)(c.Z,{children:[(0,n.jsx)("p",{children:"Step 2. Add an account by scanning the following QR code,"}),E&&(0,n.jsx)("img",{className:f().qrCode,alt:"qrcode",src:E}),(0,n.jsx)("p",{children:"or entering the following key"}),E&&(0,n.jsxs)("p",{children:[V.key," ",(0,n.jsx)(d.Z,{variant:"light",size:"sm",onClick:()=>{navigator.clipboard.writeText(V.key),T(!0)},children:R?"Copied":"Copy"})]})]}),(0,n.jsx)(c.Z,{children:(0,n.jsx)("p",{children:"Step 3. Enter the token displayed on your app, then verify."})}),(0,n.jsxs)(c.Z,{children:[(0,n.jsx)(l.Z,{xs:4,md:3,children:(0,n.jsx)(o.Z.Control,{className:f().inputBox,size:"lg",type:"text",placeholder:"",value:_,onChange:e=>F(e.target.value)})}),(0,n.jsx)(l.Z,{xs:8,md:9,children:(0,n.jsx)(d.Z,{variant:"primary",onClick:K,children:"Verify"})})]}),(0,n.jsx)(c.Z,{children:V&&!V.mfaSetup&&"InvalidToken"===V.error&&(0,n.jsx)("p",{style:{color:"red"},children:"Invalid Token"})}),(0,n.jsx)("br",{}),(0,n.jsx)(c.Z,{children:(0,n.jsx)("p",{children:"Step 4. Store your recovery phrase in a secure location. You would need the recovery phrase if you lost your 2FA account."})})]}),(0,n.jsx)(u.Z,{show:S,onEntered:()=>{g(!0)},children:(0,n.jsxs)(u.Z.Body,{children:[(0,n.jsx)("h3",{children:"Please Enter your Password"}),(0,n.jsx)("br",{}),(0,n.jsx)(y.Z,{onKeyChanged:e=>{s(e)},focus:j}),G&&!G.verified?(0,n.jsx)("p",{style:{color:"red"},children:"Authentication Failed"}):(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)(d.Z,{variant:"primary",onClick:X,className:"pull-right",children:"Go"})]})})]})})}}},function(e){e.O(0,[3937,2592,1011,2888,9774,179],function(){return e(e.s=26028)}),_N_E=e.O()}]);