(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3486],{56741:function(e,r,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/services/mfa",function(){return a(31561)}])},5401:function(e,r,a){"use strict";a.d(r,{Z:function(){return g}});var s=a(94184),l=a.n(s),t=a(67294),n=a(54728),c=a(85893);let i=t.forwardRef((e,r)=>{let{className:a,bsPrefix:s,as:t="div",...i}=e;return s=(0,n.vE)(s,"card-body"),(0,c.jsx)(t,{ref:r,className:l()(a,s),...i})});i.displayName="CardBody";let d=t.forwardRef((e,r)=>{let{className:a,bsPrefix:s,as:t="div",...i}=e;return s=(0,n.vE)(s,"card-footer"),(0,c.jsx)(t,{ref:r,className:l()(a,s),...i})});d.displayName="CardFooter";var o=a(54921);let u=t.forwardRef((e,r)=>{let{bsPrefix:a,className:s,as:i="div",...d}=e,u=(0,n.vE)(a,"card-header"),f=(0,t.useMemo)(()=>({cardHeaderBsPrefix:u}),[u]);return(0,c.jsx)(o.Z.Provider,{value:f,children:(0,c.jsx)(i,{ref:r,...d,className:l()(s,u)})})});u.displayName="CardHeader";let f=t.forwardRef((e,r)=>{let{bsPrefix:a,className:s,variant:t,as:i="img",...d}=e,o=(0,n.vE)(a,"card-img");return(0,c.jsx)(i,{ref:r,className:l()(t?"".concat(o,"-").concat(t):o,s),...d})});f.displayName="CardImg";let h=t.forwardRef((e,r)=>{let{className:a,bsPrefix:s,as:t="div",...i}=e;return s=(0,n.vE)(s,"card-img-overlay"),(0,c.jsx)(t,{ref:r,className:l()(a,s),...i})});h.displayName="CardImgOverlay";let x=t.forwardRef((e,r)=>{let{className:a,bsPrefix:s,as:t="a",...i}=e;return s=(0,n.vE)(s,"card-link"),(0,c.jsx)(t,{ref:r,className:l()(a,s),...i})});x.displayName="CardLink";var v=a(68236);let j=(0,v.Z)("h6"),m=t.forwardRef((e,r)=>{let{className:a,bsPrefix:s,as:t=j,...i}=e;return s=(0,n.vE)(s,"card-subtitle"),(0,c.jsx)(t,{ref:r,className:l()(a,s),...i})});m.displayName="CardSubtitle";let p=t.forwardRef((e,r)=>{let{className:a,bsPrefix:s,as:t="p",...i}=e;return s=(0,n.vE)(s,"card-text"),(0,c.jsx)(t,{ref:r,className:l()(a,s),...i})});p.displayName="CardText";let y=(0,v.Z)("h5"),N=t.forwardRef((e,r)=>{let{className:a,bsPrefix:s,as:t=y,...i}=e;return s=(0,n.vE)(s,"card-title"),(0,c.jsx)(t,{ref:r,className:l()(a,s),...i})});N.displayName="CardTitle";let Z=t.forwardRef((e,r)=>{let{bsPrefix:a,className:s,bg:t,text:d,border:o,body:u=!1,children:f,as:h="div",...x}=e,v=(0,n.vE)(a,"card");return(0,c.jsx)(h,{ref:r,...x,className:l()(s,v,t&&"bg-".concat(t),d&&"text-".concat(d),o&&"border-".concat(o)),children:u?(0,c.jsx)(i,{children:f}):f})});Z.displayName="Card";var g=Object.assign(Z,{Img:f,Title:N,Subtitle:m,Body:i,Link:x,Text:p,Header:u,Footer:d,ImgOverlay:h})},31561:function(e,r,a){"use strict";a.r(r),a.d(r,{default:function(){return y}});var s=a(85893),l=a(67294),t=a(9473),n=a(11163),c=a(33353),i=a(5401),d=a(68888),o=a(88083),u=a(14153),f=a(76529),h=a(56693),x=a(82354),v=a.n(x),j=a(81011),m=a(6594),p=a(28714);function y(){let e=(0,n.useRouter)(),r=(0,t.I0)(),[a,x]=(0,l.useState)(""),[y,N]=(0,l.useState)(!1),[Z,g]=(0,l.useState)(""),C=(0,l.useRef)(null),w=(0,l.useRef)(null),R=(0,l.useRef)(null),E=(0,t.v9)(e=>e.auth.mfa),b=(0,t.v9)(e=>e.auth.isLoggedIn);return(0,l.useEffect)(()=>{w.current.focus()},[]),(0,l.useEffect)(()=>{b&&e.push("/safe")},[b]),(0,s.jsx)(j.Z,{children:(0,s.jsx)(c.Z,{children:(0,s.jsxs)("div",{className:"m-3",children:[(0,s.jsx)("br",{}),(0,s.jsx)("br",{}),(0,s.jsxs)(i.Z,{className:"p-3",children:[(0,s.jsxs)(d.Z,{children:[(0,s.jsx)("h1",{children:"Second-Factor Authentication (2FA)"}),(0,s.jsx)("h6",{children:"Please enter the token"})]}),(0,s.jsxs)(d.Z,{children:[(0,s.jsx)(o.Z,{xs:4,md:3,children:(0,s.jsx)(u.Z.Control,{ref:w,className:v().inputBox,size:"lg",type:"text",placeholder:"",value:a,onChange:e=>x(e.target.value)})}),(0,s.jsx)(o.Z,{xs:8,md:9,children:(0,s.jsx)(f.Z,{variant:"primary",onClick:()=>{try{r((0,m.zs)({token:a})),x("")}catch(e){alert(e)}},children:"Verify"})})]}),E&&!E.passed&&(0,s.jsx)(d.Z,{children:(0,s.jsx)(o.Z,{children:(0,s.jsx)("p",{style:{color:"red"},children:"Authentication failed!"})})}),(0,s.jsx)(d.Z,{children:(0,s.jsx)(o.Z,{children:(0,s.jsx)(f.Z,{size:"sm",className:"pull-left",variant:"link",onClick:()=>N(!0),children:"Recover"})})}),(0,s.jsxs)(h.Z,{show:y,fullscreen:!0,onHide:()=>N(!1),children:[(0,s.jsx)(h.Z.Header,{closeButton:!0,children:(0,s.jsx)(h.Z.Title,{children:"2FA Recovery Words"})}),(0,s.jsxs)(h.Z.Body,{children:[(0,s.jsx)("p",{children:"If you lose your 2FA authenticator account, using recovery phrase is the only way to pass the 2FA step."}),(0,s.jsx)("p",{children:"You can either enter your account recovery phrase below"}),(0,s.jsx)(d.Z,{children:(0,s.jsx)(o.Z,{children:(0,s.jsx)(u.Z.Control,{ref:R,className:v().inputBox,size:"lg",type:"text",placeholder:"",value:Z,onChange:e=>g(e.target.value)})})}),(0,s.jsx)("br",{}),(0,s.jsx)(d.Z,{children:(0,s.jsx)(o.Z,{className:"text-center",children:(0,s.jsx)(f.Z,{variant:"primary",onClick:()=>{N(!1),g(""),r((0,m.JA)({recoveryWords:Z}))},children:"Recover"})})}),(0,s.jsx)("br",{}),(0,s.jsx)("p",{children:"or open your 2FA recovery file."}),(0,s.jsxs)("div",{className:"recoveryFile",children:[(0,s.jsx)("input",{ref:C,onChange:e=>{e.preventDefault(),(0,p.qu)(!1,"handleRecoveryFile: ",e.target.id);let a=e.target.files[0],s=new FileReader;s.addEventListener("load",()=>{r((0,m.JA)({recoveryWords:s.result}))},!1),a&&s.readAsText(a)},type:"file",id:"recoveryFile",className:"d-none editControl"}),(0,s.jsx)(d.Z,{children:(0,s.jsx)(o.Z,{id:"recoveryFile",sm:{span:10,offset:1},md:{span:8,offset:2},className:"text-center",children:(0,s.jsx)(f.Z,{id:"recoveryFile",onClick:e=>{var r;(0,p.qu)(!1,"handleRecoveryFile"),e.preventDefault(),C.current.value=null,null===(r=C.current)||void 0===r||r.click()},variant:"link",className:"text-dark btn btn-labeled",children:(0,s.jsx)("h4",{children:(0,s.jsx)("i",{id:"recoveryFile",className:"fa fa-paperclip fa-lg","aria-hidden":"true"})})})})})]})]})]})]})]})})})}}},function(e){e.O(0,[3937,1011,2888,9774,179],function(){return e(e.s=56741)}),_N_E=e.O()}]);